# -*- coding: utf-8 -*-    
import os
import sys
import json
import platform
from flask import Flask,request,render_template
from views import app
if (platform.system() != "Windows"):
    import redis
   
# redis配置 
g_redisConn = None
REDIS_HOST = "172.19.228.46"
REDIS_PORT = 4500
REDIS_KEY_TURNMONEY = "TurnMoneyRecode" # 输赢排行榜key
REDIS_KEY_ALLMONEY = "AllMoneyRecode" # 资产排行榜key

# 展示图表页面
@app.route('/chart', methods=['GET'])
def ShowChart():    
    return render_template('chart.html')

# 展示资产排行榜
@app.route('/allmoneyrank', methods=['GET'])
def ShowAllMoneyRank():
    global g_redisConn
    if (platform.system() != "Windows"):
        if(g_redisConn == None):
            g_redisConn = redis.Redis(REDIS_HOST, REDIS_PORT)
        allMoneyRank = g_redisConn.get(REDIS_KEY_ALLMONEY)
    else:
        allMoneyRank = "[[2562393, 400130313237], [364736, 104270955008], [2781697, 100682414371], [1396119, 94350680723], [2858301, 82901043249], [2292790, 74696605049], [1564526, 72600486380], [705690, 66724740082], [1338092, 55350702944], [2462214, 52193057924], [2460379, 47499285610], [487112, 37455373963], [1493287, 37246271352], [771061, 36635945031], [2938145, 36343476667], [1988903, 34975701532], [1004711, 33729171761], [1076970, 33045058605], [2678032, 29015759624], [1465553, 27979254498], [854590, 26976454301], [2238727, 26204026432], [2780624, 25324546607], [205162, 24265085375], [492993, 24223765419], [463865, 23530630832], [1988542, 23150851149], [2108603, 22697980834], [849396, 22515428684], [872459, 22000031833], [235187, 21906325487], [2319763, 21721856108], [1343445, 21206904101], [1886791, 21067255701], [2606030, 20283171173], [2866569, 20086198742], [2351673, 20002880130], [1707487, 19605537517], [1056645, 19576259816], [2037579, 19293295424], [632482, 18546587996], [3140684, 18327500000], [2167260, 18221610309], [2512772, 18076770779], [2777488, 17936794884], [1337890, 17617539751], [3124154, 17441686458], [681439, 17240425053], [2669616, 16875110252], [1257874, 16574148518], [248686, 16290686141], [1221949, 16061346394], [1795823, 15928944336], [2943963, 15805842522], [348221, 15795424600], [528408, 15709938754], [2837618, 15578170059], [2489024, 14817136414], [289857, 14735999556], [1809372, 14633000565], [409785, 14574035799], [169385, 14360156659], [421935, 14181779512], [1435808, 14092821691], [515693, 14015819454], [1420453, 13998589915], [2487017, 13878616573], [2661460, 13801158440], [2216159, 13688311552], [419305, 13539164587], [1574585, 13505864675], [2380860, 13502297841], [813213, 13032172599], [2524716, 12849863539], [702464, 12652150788], [2523932, 12609958417], [608495, 12585858489], [2431289, 12528031051], [2978709, 12426865398], [1568042, 12273735651], [3053601, 12162130876], [1268945, 12138892174], [1974783, 12027515315], [662797, 12015059456], [1135158, 11992709228], [1418898, 11641322856], [486041, 11600469759], [672764, 11567745720], [2183273, 11553023820], [2214072, 11423041779], [2034544, 11343965662], [1677582, 11296309914], [1140935, 11282870958], [1191365, 11211711362], [2031187, 11204618488], [2208462, 11094590087], [1807222, 11018891801], [108395, 10908315954], [2651291, 10767671201], [247615, 10747254474]]"
    return render_template('rank.html', allmoney=allMoneyRank)

# 展示输赢排行榜
@app.route('/turnmoneyrank', methods=['GET'])
def ShowWinLoseRank():
    global g_redisConn
    if (platform.system() != "Windows"):
        if(g_redisConn == None):
            g_redisConn = redis.Redis(REDIS_HOST, REDIS_PORT)
        turnMoneyRank = g_redisConn.get(REDIS_KEY_TURNMONEY)
    else:
        turnMoneyRank = "[[2562393, 99209900000], [2858301, 29879626041], [1564526, 24182134358], [3140684, 12918700000], [1886791, 9307921743], [2208462, 9077411363], [3154947, 8602867386], [2226618, 7828288435], [3072474, 7821858249], [3159805, 7633058618], [2216159, 7595876572], [2292512, 7579307559], [1736720, 7217173115], [2834782, 7178993386], [1613032, 7122169595], [2256362, 7082006899], [2856642, 7059509008], [1977076, 6692928793], [2627495, 6575477682], [348221, 6536200000], [1809372, 6375131115], [2031187, 6337153846], [3010635, 6310808035], [3022774, 6163909758], [2678032, 6147950831], [2487017, 6124200000], [3124154, 6073464297], [3053601, 6017019986], [1795823, 5971952010], [2918261, 5849308421], [3041375, 5810545200], [303306, 5647478071], [3132685, 5607716618], [1977635, 5574520409], [2351673, 5565753695], [2238727, 5565056588], [2938145, 5478339098], [400700, 5438697416], [2926174, 5372919046], [2681861, 5308516197], [248686, 5134078919], [515693, 4844900544], [2460355, 4679903240], [2431289, 4571457024], [285288, 4270919381], [228564, 4270500000], [2108603, 4167847102], [145038, 3930276069], [2638386, 3889677179], [841398, 3885182962], [2922532, 3710992000], [2719258, 3571451717], [2523932, 3563435484], [2148812, 3537500000], [2063182, 3507586914], [2870228, 3499062946], [487112, 3455298172], [901577, 3441989195], [2461088, 3425452523], [1522958, 3405272908], [2244152, 3387805343], [432826, 3360055583], [2589692, 3292897539], [693210, 3289222763], [1797588, 3245647734], [3150711, 3190433834], [2319763, 3090240686], [2792208, 3081000000], [2644437, 3075368886], [2261742, 3057384624], [1319851, 2983900000], [2221500, 2954470979], [1947358, 2896792827], [2797642, 2887296777], [2439357, 2815222833], [261848, 2789262077], [1922557, 2784500000], [2973719, 2747024823], [2296253, 2731079332], [659987, 2726503653], [3162309, 2710971181], [2943963, 2708458048], [3156190, 2657793010], [3063146, 2629094156], [3096633, 2624227672], [100319, 2602240000], [3153865, 2601391239], [3087551, 2579329455], [2651734, 2538611952], [1809603, 2537757268], [1887017, 2530690993], [1249405, 2498879109], [3160936, 2497629611], [3108334, 2464352895], [3145919, 2431583429], [2066211, 2431000000], [1592401, 2390621282], [2033122, 2388204818], [337507, 2373893785], [2273362, 2367319905]]"
    return render_template('rank.html', turnmoney=turnMoneyRank)
